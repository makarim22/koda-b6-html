<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" href="profile.css" />
  <title>Profile - Coffee Shop</title>
</head>

<body>
  <header class="container">
    <div class="logo">
      <div>
        <img src="./src/icons/home/Frame.svg" alt="Menu" />
        <img src="./src/icons/home/Logo.svg" alt="Logo" />
      </div>
      <div>
        <nav class="left-header">
          <a href="home.html">Home</a>
          <a href="product.html">Product</a>
        </nav>

      </div>

    </div>
    <div class="search-container">
      <nav class="right-header">
        <img src="./src/icons/Search.svg" alt="Search" />
        <img src="./src/icons/ShoppingCart.svg" alt="Cart" />
        <a class="login-button" href="login.html">Sign In</a>
        <a class="register-button" href="register.html">Sign Up</a>
      </nav>
    </div>
  </header>

  <main class="main-content">
    <h1 class="page-title">Profile</h1>

    <div class="profile-container">

      <div class="profile-card">
        <!-- <h2 class="profile-name">Ghaluh Wizard</h2>
        <p class="profile-email">ghaluhwizz@gmail.com</p> 
        
        <div class="profile-image-wrapper">
        </div>
        
        <button class="upload-btn">Upload New Photo</button>
        
        <p class="join-date">Since 20 January 2022</p>  -->
      </div>

      <div class="profile-form">

        <div class="form-group">
          <label for="fullname">Full Name</label>
          <div class="input-wrapper">
            <img src="./src/icons/Profile.png" alt="Name Icon" class="input-icon" />
            <input type="text" id="fullname" name="fullname" placeholder="Ghaluh Wizard" value="Ghaluh Wizard" />
          </div>
        </div>

        <div class="form-group">
          <label for="email">Email</label>
          <div class="input-wrapper">
            <img src="./src/icons/mail.svg" alt="Email Icon" class="input-icon" />
            <input type="email" id="email" name="email" placeholder="ghaluhwizz@gmail.com"
              value="ghaluhwizz@gmail.com" />
          </div>
        </div>

        <div class="form-group">
          <label for="phone">Phone</label>
          <div class="input-wrapper">
            <img src="./src/icons/phone.svg" alt="Phone Icon" class="input-icon" />
            <input type="tel" id="phone" name="phone" placeholder="08216304338" value="08216304338" />
          </div>
        </div>

        <div class="form-group">
          <div class="password-header">
            <label for="password">Password</label>
            <a href="#" class="set-password-link">Set New Password</a>
          </div>
          <div class="input-wrapper">
            <img src="./src/icons/Password.svg" alt="Password Icon" class="input-icon" />
            <input type="password" id="password" name="password" value="••••••••" disabled />
            <img src="./src/icons/EyeSlash.svg" alt="Show/Hide" class="toggle-password" />
          </div>
        </div>

        <div class="form-group">
          <label for="address">Address</label>
          <div class="input-wrapper">
            <img src="./src/icons/location.svg" alt="Location Icon" class="input-icon" />
            <input type="text" id="address" name="address" placeholder="Griya Bandung Indah"
              value="Griya Bandung Indah" />
          </div>
        </div>

        <button class="submit-btn">Submit</button>
      </div>

    </div>
  </main>

  <footer class="footer">
    <div class="footer-content">
      <div class="footer-section about">
        <img src="./src/icons/coffee-cup.svg">
        <img src="./src/icons/coffee-shop.svg">
        <p style="margin-top: 20px;">
          Coffee Shop is a store that sells some good meals, and especially
          coffee. We provide high quality beans.
        </p>
        <p>&copy; 2020 CoffeeStore</p>
      </div>
      <div class="footer-section products">
        <h3>Product</h3>
        <ul>
          <li>Our Product</li>
          <li>Pricing</li>
          <li>Locations</li>
          <li>Countries</li>
          <li>Blog</li>
        </ul>
      </div>
      <div class="footer-section engage">
        <h3>Engage</h3>
        <ul>
          <li>Partner</li>
          <li>FAQ</li>
          <li>About Us</li>
          <li>Privacy Policy</li>
          <li>Terms of Service</li>
        </ul>
      </div>
      <div class="footer-section social-media">
        <h3>Social Media</h3>
        <div class="social-icons">
          <img src="./src/icons/Facebook.svg" alt="Facebook" />
          <img src="./src/icons/Twitter.svg" alt="Twitter" />
          <img src="./src/icons/Instagram.png" alt="Instagram" />
        </div>
      </div>
    </div>
  </footer>

  <script>
    const profileCard = document.querySelector(".profile-card");
    // const user = JSON.parse(localStorage.getItem("user-data"));
    // console.log('usernyaa', user);
    // const userLoggedin = user.find((user) => user.isLoggedIn === true);
    // console.log('userLoggedIn', userLoggedIn);

    const users = JSON.parse(localStorage.getItem("user-data"));
    const loggedInUser = users.find(user => user.isLoggedIn);

    if (loggedInUser) {

      const profileName = document.createElement("h2");
      profileName.textContent = loggedInUser.name;
      profileCard.appendChild(profileName);

      const profileEmail = document.createElement("p");
      profileEmail.textContent = loggedInUser.email;
      profileCard.appendChild(profileEmail);
    }

    const imageWrapper = document.createElement("div");
    imageWrapper.classList.add("image-wrapper");

    profileCard.appendChild(imageWrapper);

    const buttonSubmit = document.createElement("button");
    buttonSubmit.classList.add("upload-btn");
    buttonSubmit.textContent = "Upload New Photo";
    profileCard.appendChild(buttonSubmit);

    const joinDate = document.createElement("p");
    joinDate.classList.add("join-date");
    joinDate.textContent = "Since 20 January 2022";
    profileCard.appendChild(joinDate);

    const profileNameElement = document.querySelector(".profile-card .profile-name");
    if (profileNameElement) profileNameElement.textContent = loggedInUser.name;

    const profileEmailElement = document.querySelector(".profile-card .profile-email");
    if (profileEmailElement) profileEmailElement.textContent = loggedInUser.email;

    const profileImageWrapper = document.querySelector(".profile-card .profile-image-wrapper");
    if (profileImageWrapper) {
      let imgElement = profileImageWrapper.querySelector('img');
      if (!imgElement) {
        imgElement = document.createElement('img');
        profileImageWrapper.appendChild(imgElement);
      }
      imgElement.src = loggedInUser.profileImageUrl || 'assets/default-profile.jpg';
      imgElement.alt = loggedInUser.name ? `${loggedInUser.name}'s Profile Picture` : 'Profile Picture';
    }

    const joinDateElement = document.querySelector(".profile-card .join-date");
    if (joinDateElement) {
      joinDateElement.textContent = `Since ${loggedInUser.joinDate || '20 January 2022'}`;
    }

    const fullnameInput = document.getElementById("fullname");
    if (fullnameInput) {
      fullnameInput.value = loggedInUser.name;
      fullnameInput.placeholder = loggedInUser.name;
    }

    const emailInput = document.getElementById("email");
    if (emailInput) {
      emailInput.value = loggedInUser.email;
      emailInput.placeholder = loggedInUser.email;
    }

    const phoneInput = document.getElementById("phone");
    if (phoneInput) {
      phoneInput.value = loggedInUser.phone || "";
      phoneInput.placeholder = loggedInUser.phone || "Enter your phone number";
    }

    const addressInput = document.getElementById("address");
    if (addressInput) {
      addressInput.value = loggedInUser.address || "";
      addressInput.placeholder = loggedInUser.address || "Enter your address";
    }

    const passwordInput = document.getElementById("password");
    if (passwordInput) {


    }

    const submitBtn = document.querySelector(".submit-btn");
    if (submitBtn) {
      submitBtn.addEventListener("click", () => {

        const phone = phoneInput.value;
        const address = addressInput.value;

        const updatedUserData = {
          ...loggedInUser,
          phone: phone,
          address: address,
        };
        const updatedUsers = users.map(user =>
          user.email === loggedInUser.email ? updatedUserData : user
        );
        localStorage.setItem("user-data", JSON.stringify(updatedUsers));
        alert("Profile updated successfully!");
      });
    }

    const header = document.querySelector(".right-header");

    creds = localStorage.getItem("user-data");
    console.log('credsnya', creds);

    if (creds) {
      credsNew = JSON.parse(creds);
      user = credsNew.find((user) => user.isLoggedIn === true);
      console.log('creds', creds);
      console.log('user', user);


      const signIn = document.querySelector(".login-button");
      signIn.textContent = `Hi, ${user.name}`;
      signIn.href = "#";

      const signOut = document.querySelector(".register-button");
      signOut.textContent = "Logout";

      signOut.addEventListener("click", () => {
        user.isLoggedIn = false;
        localStorage.setItem("user-data", JSON.stringify(creds));
        signOut.href = "login.html";
      })

    }







  </script>
</body>

</html>